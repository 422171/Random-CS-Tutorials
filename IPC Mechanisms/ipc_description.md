# IPC Description

## Server and Cient
> client initiates communication. Server gets query and responds. The client reads the response.
- **client file**- send msg and receive data sent
- **server file**- receive msg and send data required
---

## IPC  using named pipes (FIFO)
### `mkfifo()`
- **Description**: Creates a named pipe.
- **Parameters**:
  - `pathname`: The name of the pipe.
  - `mode`: The permissions for the pipe.
- **Return**: `0` on success, `-1` on error.
- **Behavior**: Acts like a file from which we can read/write.
  - Default: Blocked mode (one process writes, the other reads).
  - The sender is blocked until the receiver can read.
- **Instructions**: To read from or write to the named pipe, use a file descriptor with POSIX functions
  - Posix Functions: `open`, `read`, `write`, `close`

## IPC using message queues
### `ftok()`
- **Description**: Generates a unique key.
- **Parameters**:
  - `pathname`: The path to an existing file.
  - `project_id`: A unique integer or character.

### `msgget()`
- **Description**: Creates a message queue.
- **Parameters**:
  - `key`: The key generated by `ftok()`.
  - `flags`: Flags for permissions and creation options.

### `msgsnd()`
- **Description**: Sends a message to a message queue.
- **Parameters**: 
  - `queue_id`: The identifier of the message queue.
  - `msgp`: Pointer to the message.
  - `msgsz`: Size of the message.
  - `msgflg`: Flags for sending options.

### `msgrcv()`
- **Description**: Receives a message from a message queue.
- **Parameters**: 
  - `queue_id`: The identifier of the message queue.
  - `msgp`: Pointer to the message buffer.
  - `msgsz`: Size of the message buffer.
  - `msgtyp`: Type of message to receive. (type of message must match with type of message set by sender)
  - `msgflg`: Flags for receiving options. (0 for blocking, which is default) 

### `msgctl()`
- **Description**: Performs control operations on a message queue.
- **Parameters**: 
  - `queue_id`: The identifier of the message queue.
  - `cmd`: The command to perform.
  - `buf`: Pointer to `msqid_ds` structure.
- **To remove a message queue**: 
  ```c 
  msgctl(queue_id, IPC_RMID, NULL) 
  /* NULL means no need to pass msqid_ds structure */
## IPC Using Shared Memory

### `ftok()` (described above)
- **Description**: Creates a key.
- **Parameters**: `pathname`, `project_id`
### `shmget()`
- **Description**: Creates a memory segment and returns an integer ID.
- **Parameters**:
  - `key`: The key generated by `ftok()`.
  - `size`: Desired size in bytes (e.g., `1024` means 1KB; can use `sizeof(data_structure) * n`).
  - `flags`: Flags for permissions and creation options.

### `shmat()`
- **Description**: Attaches the shared memory segment to the process's address space.
- **Parameters**:
  - `shmid`: The shared memory ID returned by `shmget()`.
  - `shmaddr`: Address to attach (`NULL` or `(void*)0` means the system will choose the memory location).
  - `flags`: Flags for attaching options.

### `shmdt()`
- **Description**: Detaches the shared memory segment from the process's address space.
- **Parameters**: 
  - `shmaddr`: The address of the shared memory segment to detach (the result value of `shmat()`)

### `shmctl()`
- **Description**: Get/set segment info or remove the segment. 
- **Parameters**:
  - `shmid`: The shared memory ID.
  - `cmd`: The command to perform (e.g., `IPC_RMID` to remove the segment).
  - `buf`: Pointer to `shmid_ds` structure (`NULL` if not needed, like in case of `IPC_RMID` cmd).

---
> **NOTE**: Almost all the times, flags argument is 0. This means we choose the default flags behaviour.